<div>
  <div>
    <h1>
      List of all assigned meals
    </h1>
  </div>
</div>

<hr>

<div>
  <div>
    <h2>
      Add a new assigned meal
    </h2>

    <form action="/insert_assigned_meal" method="post">
      <div>
        <label for="dish_id_box" class="control-label sr-only">
          Dish
        </label>
        <select class="form-control" id="dish_id_box" name="query_dish_id">
          <option value="">Choose a dish...</option>
            <%matching_dishes = Dish.all%>
            <%matching_dishes.each do |a_dish| %>
            <ul>
              <li>
                <%= a_dish.name %>
              </li>
            </ul>
          <option value="<%=a_dish.id%>"> <%=a_dish.name%> </option>
          <%end%>
        </select>
      </div>

      <div>
        <label for="assigned_to_box">
          Assigned to
        </label>

        <input type="date" id="assigned_to_box" name="query_assigned_to">
      </div>

      <div>

        <input type="hidden" name="query_user_id" value="<%= current_user.id %>">
      </div>

      <button>
        Create assigned meal
      </button>
    </form>
  </div>
</div>

<hr>
<div>
  <div>
    <table border="1">
      <tr>
<!--        <th>
          ID
        </th>-->

        <th>
          Dish
        </th>

        <th>
          Assigned to
        </th>

        <th>
          User
        </th>

        <th>
          Created at
        </th>

        <th>
          Updated at
        </th>

        <th>
        </th>
      </tr>

      <% @list_of_assigned_meals.each do |an_assigned_meal| %>
      <tr>
<!--        <td>-->
          <%#= an_assigned_meal.id %>
<!--        </td>-->

        <td>
          <%= an_assigned_meal.dish.name %>
        </td>

        <td>
          <%= an_assigned_meal.assigned_to.strftime("%a %b %e, %Y") %>
        </td>

        <td>
          <%= an_assigned_meal.user.email %>
        </td>

        <td>
          <%= time_ago_in_words(an_assigned_meal.created_at) %> ago
        </td>
        <td>
          <%= time_ago_in_words(an_assigned_meal.updated_at) %> ago
        </td>

        <td>
          <a href="/assigned_meals/<%= an_assigned_meal.id %>">
            Show details
          </a>
        </td>
      </tr>
      <% end %>
    </table>
  </div>
</div>

<hr>
