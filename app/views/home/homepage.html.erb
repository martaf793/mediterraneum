
<%#— compute Monday of this week —%>
<% today         = Date.today %>
<% start_of_week = today - ((today.wday + 6) % 7) %>

<%#— group your assigned meals by date into a Hash<Date, Array<AssignedMeal>> —%>
<% assignments_by_date = @list_of_assigned_meals.group_by { |am| am.assigned_to } %>

<div>
  <h1>Weekly Meal Plan</h1>
  <table border="1">
    <tr>
      <th>Slot</th>
      <th>Monday</th>
      <th>Tuesday</th>
      <th>Wednesday</th>
      <th>Thursday</th>
      <th>Friday</th>
      <th>Saturday</th>
      <th>Sunday</th>
    </tr>

    <%#— exactly five generic slots —%>
    <% (0..4).each do |slot_index| %>
      <tr>
        <td>Dish number <%= slot_index + 1 %></td>

        <%#— for each day of the week —%>
        <% (0..6).each do |offset| %>
          <% day = start_of_week + offset %>
          <% todays = assignments_by_date.fetch(day, []) %>
          <% assigned_meal = todays.at(slot_index) %>

          <td>
            <% if assigned_meal %>
              <%= assigned_meal.dish.name %>
            <% end %>
          </td>
        <% end %>
      </tr>
    <% end %>
  </table>
</div>

<hr>
